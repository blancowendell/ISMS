<script>
    $(document).ready(function () {
        // // Function to get query parameters by name
        // function getQueryParam(name) {
        //     const urlParams = new URLSearchParams(window.location.search);
        //     return urlParams.get(name);
        // }

        // Extract token from URL
        // const token = getQueryParam('token');

        $(document).on("click", "#resetPasswordForm", function () {
            const newPassword = $('#newPassword').val();
            const token = $('#token').val();


            var message = "";

            if (token === "") {
                message += "Token is required ";
            }


            if (newPassword === "") {
                message += "New Password is required ";
            }

            if (message !== "") {
                showSweetAlert("Required", `Please fill up ${message}`);
            } else {
                $.ajax({
                    type: "POST",
                    url: '/forgotpassword/resetpassword',
                    contentType: 'application/json',
                    data: JSON.stringify({ token, newPassword }),
                    success: function (result) {
                        if (result.msg === "success") {
                            swal(
                                "Save Successfully",
                                "You clicked the button!",
                                "success"
                            ).then((results) => {
                                if (result.data[0]) {
                                    location.replace("/studentindex");
                                } else {
                                    location.replace("/login");
                                }
                            });
                        } else if (result.msg === "graduated") {
                            showSweetAlert(
                                "Graduated",
                                "Your account is inactive. Please be guided accordingly.",
                                "error",
                                "Ok"
                            );
                        } else if (result.msg === "incorrect") {
                            showSweetAlert(
                                "Incorrect",
                                "Incorrect Credentials. Please try again!",
                                "error",
                                "AWW NO!!"
                            );
                        }
                    },
                    error: function (err) {
                        swal("Error", "An error occurred while saving data.", "error");
                    },
                });
            }
        });
    });
</script>