<script>
  $(document).ready(function () {
    console.log("Initialize");

    $(document).on("keydown", function (event) {
      // Check if the Enter key is pressed
      if (event.key === "Enter") {
        $("#createbtn").click();
      }
    });

    $(document).on("click", "#createbtn", function () {
      let studentId = $("#studentid").val();
      let userName = $("#username").val();
      let passWord = $("#password").val();
      let confirmPassWord = $("#confirmpassword").val();

      var message = "";

      // Form validation
      if (studentId == "") {
        message += "Student ID is required. ";
      }

      if (userName == "") {
        message += "Username is required. ";
      }

      if (passWord == "") {
        message += "Password is required. ";
      }

      if (confirmPassWord == "") {
        message += "Confirm Password is required. ";
      }

      if (passWord !== confirmPassWord) {
        message += "Passwords do not match. ";
      }

      if (message !== "") {
        swal("Validation Error", message, "error");
      } else {
        // Ajax request to create user
        $.ajax({
          type: "POST",
          url: "/createuser/save",
          data: {
            studentid: studentId,
            username: userName,
            password: passWord,
          },
          success: function (result) {
            if (result.msg == "success") {
              swal({
                title: "Saved Successfully",
                text: "Account created successfully!",
                icon: "success",
                button: "OK!",
              }).then((results) => {
                window.location.href = "/login";
              });
            } else {
              swal({
                title: "Mukang Mag Kakilala na Tayo?",
                text: "you already have an account!",
                icon: "warning",
                button: "OK!",
              });
            }
          },
          error: function (err) {
            // Handle error during user creation
            swal(
              "Error",
              "An error occurred while creating the account!",
              "warning"
            );
          },
        });
      }
    });

    $(".toggle-password").on("click", function () {
      const targetSelector = $(this).data("target");
      const passwordInput = $(targetSelector);
      const passwordFieldType = passwordInput.attr("type");
      if (passwordFieldType === "password") {
        passwordInput.attr("type", "text");
        $(this).find("i").removeClass("fa-eye").addClass("fa-eye-slash");
      } else {
        passwordInput.attr("type", "password");
        $(this).find("i").removeClass("fa-eye-slash").addClass("fa-eye");
      }
    });
  });
</script>