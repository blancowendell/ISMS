<script>
  $(document).ready(function () {
    let anouncementdiv = "";
    GenerateAnnouncement();
    updateTime();

    $("#proceedButton").click(function () {
      window.location.href = "/finishapplication";
    });

    function updateTime() {
      const now = new Date();

      let hours = now.getHours();
      let minutes = now.getMinutes();
      let seconds = now.getSeconds();
      const ampm = hours >= 12 ? "PM" : "AM";

      hours = hours % 12;
      hours = hours ? hours : 12;
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;

      const strTime = `${hours}:${minutes}:${seconds} ${ampm}`;

      // Format date
      const day = now.getDate();
      const month = now.toLocaleString("default", { month: "short" });
      const year = now.getFullYear();
      const strDate = `${day} ${month} ${year}`;

      // Update the content
      document.getElementById(
        "dynamic-time"
      ).innerHTML = `${strTime} / ${strDate}`;
    }

    // Update the time every second
    setInterval(updateTime, 1000);

    // Initialize the clock
    updateTime();
    // function GenerateAnnouncement() {
    //   $.ajax({
    //     type: "GET",
    //     url: "studentindex/getbulletin",
    //     success: function (result) {
    //       let announcementDiv = ''; // Initialize as empty string

    //       if (result.msg === "success" && result.data.length > 0) {
    //         const announcementData = result.data;
    //         let counter = 0;

    //         $.each(announcementData, (key, item) => {
    //           counter++;
    //           announcementDiv += `
    //         <div class="carousel-item ${counter === 1 ? 'active' : ''}" data-bs-interval="3000">
    //           <div class="row">
    //             <!-- Description on the left -->
    //             <div class="col-md-6 d-flex align-items-center">
    //               <div class="announcement-content">
    //                 <h6 id="announcedate${counter}" class="a-date">${item.targetdate}</h6>
    //                 <h6 id="announcetitle${counter}" class="announce-title">${item.title}</h6>
    //                 <p id="announcedesc${counter}" class="a-des">${item.description}</p>
    //               </div>
    //             </div>
    //             <!-- Image on the right -->
    //             <div class="col-md-6">
    //               <img id="preview${counter}" src="data:image/jpg;base64,${item.image}"
    //                class="d-block w-100 eportal-img-announce" alt="...">
    //             </div>
    //           </div>
    //         </div>`;
    //         });
    //       } else {
    //         // No announcements available
    //         announcementDiv = `
    //       <div class="carousel-item active">
    //         <div class="row">
    //           <div class="col-12 text-center">
    //             <p>No announcements today.</p>
    //           </div>
    //         </div>
    //       </div>`;
    //       }

    //       $("#carouselannouncement").html(announcementDiv);
    //     },
    //     error: function (err) {
    //       if (err.status === 404 && err.responseJSON && err.responseJSON.msg === "no announcements today") {
    //         // Handle the case when no announcements are available
    //         $("#carouselannouncement").html(`
    //       <div class="carousel-item active">
    //         <div class="row">
    //           <div class="col-12 text-center">
    //             <p>No announcements today.</p>
    //           </div>
    //         </div>
    //       </div>
    //     `);
    //       } else {
    //         console.error("AJAX Error: ", err.responseText);
    //         swal(
    //           "An error occurred while fetching announcement data",
    //           "Please try again later.",
    //           "error"
    //         );
    //       }
    //     },
    //   });
    // }
    function GenerateAnnouncement() {
      $.ajax({
        type: "GET",
        url: "studentindex/getbulletin",
        success: function (result) {
          let announcementDiv = "";

          if (result.msg === "success" && result.data.length > 0) {
            const announcementData = result.data;
            let counter = 0;

            $(".carousel-inner").empty();

            $.each(announcementData, (key, item) => {
              counter++;

              let announcementDiv = `
              <div class="carousel-item ${
                counter === 1 ? "active" : ""
              }" data-bs-interval="3000">
                <div class="row">
                  <div class="col-12 col-md-6">
                    <div class="announcement-content p-3">
                      <h6 class="a-date">${item.targetdate}</h6>
                      <h6 class="announce-title">${item.title}</h6>
                      <p class="a-des">${item.description}</p>
                    </div>
                  </div>
                  <div class="col-12 col-md-6">
                    <img src="data:image/jpg;base64,${
                      item.image
                    }" class="d-block w-100 eportal-img-announce img-fluid" alt="Announcement Image">
                  </div>
                </div>
              </div>`;

              $(".carousel-inner").append(announcementDiv);
            });
          } else {
            announcementDiv = `
            <div class="carousel-item active">
              <div class="row">
                <div class="col-12 text-center">
                  <p>No announcements today.</p>
                </div>
              </div>
            </div>`;
            $(".carousel-inner").html(announcementDiv);
          }

          var carouselElement = document.querySelector("#carouselannouncement");
          var carousel = new bootstrap.Carousel(carouselElement, {
            interval: 3000,
          });
        },
        error: function (err) {
          console.error("AJAX Error: ", err.responseText);
          swal(
            "An error occurred while fetching announcement data",
            "Please try again later.",
            "error"
          );
        },
      });
    }
  });
</script>
